-- BACS SQL 모음
-- 회원
CREATE TABLE BACS_USER (
    USER_ID VARCHAR2(30) PRIMARY KEY , -- 회원 아이디
    USER_PW VARCHAR2(100) NOT NULL , -- 회원 비밀번호
    EMAIL VARCHAR2(100) NOT NULL , -- 회원 이메일
    PHONE VARCHAR2(20) NOT NULL , -- 대표 전화번호
    ROLENAME VARCHAR2(20) DEFAULT 'ROLE_USER' CHECK ( ROLENAME IN ('ROLE_USER', 'ROLE_ADMIN') ) , -- 회원 권한
    ENABLED NUMBER(1) DEFAULT 1 CHECK ( ENABLED IN (0, 1) ) , -- 차단여부
    CREATED_AT DATE DEFAULT SYSDATE -- 가입 날짜
);
-- 매장정보
CREATE TABLE BACS_STORE (
    STORE_ID VARCHAR2(30) PRIMARY KEY , -- 매장 아이디(url에 사용할 이름)
    STORE_NAME VARCHAR2(100) NOT NULL , -- 매장 이름
    STORE_ADDRESS VARCHAR2(300) DEFAULT '' , -- 매장 주소
    CR_NUM VARCHAR2(20) NOT NULL , -- 사업자등록번호
    STORE_PHONE VARCHAR2(20) DEFAULT '' , -- 매장 번호
    CREATED_AT DATE DEFAULT SYSDATE , -- 매장 가입날짜
    CONSTRAINT USER_ID_STORE_FK FOREIGN KEY (USER_ID) REFERENCES BACS_USER(USER_ID) -- 회원 아이디 외래키
);
-- 매장 홈페이지
CREATE TABLE BACS_HOMEPAGE (
    HOMEPAGE_NUM NUMBER PRIMARY KEY , -- 홈페이지 번호
    TEMPLATE_NUM NUMBER NOT NULL , -- 홈페이지 템플릿 번호
    BANNER_IMG VARCHAR2(1000) DEFAULT '' , -- 배경 사진(추후 컬럼 추가 가능)
    STORE_INTRO1 VARCHAR2(1000) DEFAULT '' , -- 가게 설명문1
    STORE_INTRO2 VARCHAR2(1000) DEFAULT '' , -- 가게 설명문2
    STORE_INTRO3 VARCHAR2(1000) DEFAULT '' , -- 가게 설명문3(추후 컬럼 추가/통폐합 가능)
    OPERATING_HOURS VARCHAR2(200) DEFAULT '' , -- 매장 운영시간(ex.월-금 10:00 ~ 22:00)
    CONSTRAINT STORE_ID_HOMEPAGE_FK FOREIGN KEY (STORE_ID) REFERENCES BACS_STORE(STORE_ID) -- 매장 아이디 외래키
);
-- 키오스크 페이지
CREATE TABLE BACS_KIOSK (
    KIOSK_NUM NUMBER PRIMARY KEY , -- 키오스크 페이지 번호
    STORE_CODE NUMBER NOT NULL , -- 업종 번호
    EASY_MODE NUMBER(1) DEFAULT 0 CHECK ( EASY_MODE IN (0, 1) ) , -- 어르신모드 on/off
    VOICE_MODE NUMBER(1) DEFAULT 0 CHECK ( VOICE_MODE IN (0, 1) ) , -- 음성인식모드 on/off
    CONSTRAINT STORE_ID_KIOSK_FK FOREIGN KEY (STORE_ID) REFERENCES BACS_STORE(STORE_ID) -- 매장 아이디 외래키
);
-- 메뉴
CREATE TABLE BACS_MENU (
    MENU_NUM NUMBER PRIMARY KEY , -- 메뉴번호
    MUNU_CATEGORY VARCHAR2(30) NOT NULL , -- 메뉴 카테고리
    MENU_NAME VARCHAR2(100) NOT NULL , -- 메뉴 이름
    MENU_PRICE NUMBER NOT NULL , -- 메뉴 가격
    MENU_IMG VARCHAR2(1000) DEFAULT '' , -- 메뉴 이미지
    MENU_DESC VARCHAR2(100) DEFAULT '' , -- 메뉴 설명
    CONSTRAINT STORE_ID_MENU_FK FOREIGN KEY (STORE_ID) REFERENCES BACS_STORE(STORE_ID) -- 매장 아이디 외래키
);
-- 메뉴옵션
CREATE TABLE BACS_MENU_OPTION (
    OPTION_NUM NUMBER PRIMARY KEY , -- 메뉴 옵션 번호
    OPTION_NAME VARCHAR2(30) NOT NULL , -- 옵션 카테고리 이름 (ex.온도)
    OPTION_VALUE VARCHAR2(100) NOT NULL , -- 옵션 값 (ex.핫, 아이스, 샷 추가 ...)
    OPTION_PRICE NUMBER NOT NULL , -- 옵션 가격(추가금)
    CONSTRAINT MENU_NUM_OPTION_FK FOREIGN KEY (MENU_NUM) REFERENCES BACS_MENU(MENU_NUM) -- 메뉴 번호 외래키
);
-- 주문
CREATE TABLE BACS_ORDER (
    ORDER_NUM NUMBER PRIMARY KEY , -- 주문번호
    ORDER_DATE DATE DEFAULT SYSDATE , -- 주문 날짜
    TOTAL_PRICE NUMBER DEFAULT 0, -- 주문 총 금액,
    TO_GO NUMBER(1) DEFAULT 0 CHECK(TO_GO IN (0, 1) ), -- 포장 여부
    CONSTRAINT STORE_ID_ORDER_FK FOREIGN KEY (STORE_ID) REFERENCES BACS_STORE(STORE_ID) -- 매장 아이디 외래키
);
-- 주문상품
CREATE TABLE BACS_ORDER_RECIPE (
    RECIPE_NUM NUMBER PRIMARY KEY , -- 주문 내역 번호
    MENU_AMOUNT NUMBER DEFAULT 1 , -- 메뉴 수량
    RECIPE_PRICE NUMBER DEFAULT 0 , -- 옵션 포함 메뉴 총 금액
    CONSTRAINT MENU_NUM_RECIPE_FK FOREIGN KEY (MENU_NUM) REFERENCES BACS_MENU(MENU_NUM) , -- 메뉴 번호 외래키
    CONSTRAINT ORDER_NUM_RECIPE_FK FOREIGN KEY (ORDER_NUM) REFERENCES BACS_ORDER(ORDER_NUM) -- 주문 번호 외래키
);
-- 옵션정보
CREATE TABLE BACS_RECIPE_OPTION (
    RO_NUM NUMBER PRIMARY KEY , -- 주문한 메뉴 옵션정보 번호
    RO_AMOUNT NUMBER DEFAULT 1 , -- 옵션 수량
    CONSTRAINT RECIPE_NUM_OPTION_FK FOREIGN KEY (RECIPE_NUM) REFERENCES BACS_ORDER_RECIPE(RECIPE_NUM) , -- 주문 내역 외래키
    CONSTRAINT OPTION_NUM_OPTION_FK FOREIGN KEY (OPTION_NUM) REFERENCES BACS_MENU_OPTION(OPTION_NUM) -- 메뉴 옵션 외래키
);
-- BACS 공지사항
CREATE TABLE BACS_NOTICE (
    NOTICE_NUM NUMBER PRIMARY KEY , -- 공지사항 번호
    NOTICE_TITLE VARCHAR2(100) NOT NULL , -- 공지사항 제목
    NOTICE_CONTENTS VARCHAR2(2000) NOT NULL , -- 공지사항 내용
    NOTICE_VIEWS NUMBER DEFAULT 0 , -- 조회수
    CREATED_AT DATE DEFAULT SYSDATE , -- 게시 날짜
    CONSTRAINT USER_ID_NOTICE_FK FOREIGN KEY (USER_ID) REFERENCES BACS_USER(USER_ID) , -- 회원 외래키
    CONSTRAINT USER_ID_NOTICE_CK CHECK ( USER_ID_NOTICE_FK.ROLENAME IN ('ROLE_ADMIN') ) -- 외래키 제약사항(관리자만 게시가능)
);
-- 매장 공지사항
CREATE TABLE STORE_NOTICE (
    NOTICE_NUM NUMBER PRIMARY KEY , -- 매장 공지사항 번호
    NOTICE_TITLE VARCHAR2(100) NOT NULL , -- 매장 공지사항 제목
    NOTICE_CONTENTS VARCHAR2(2000) NOT NULL , -- 매장 공지사항 내용
    NOTICE_VIEWS NUMBER DEFAULT 0 , -- 조회수
    CREATED_AT DATE DEFAULT SYSDATE , -- 게시날짜
    CONSTRAINT STORE_ID_NOTICE_FK FOREIGN KEY (STORE_KEY) REFERENCES BACS_STORE(STORE_ID) -- 매장 아이디 외래키
);

