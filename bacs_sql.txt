-- BACS SQL 모음
-- 회원
CREATE TABLE BACS_USER (
    userId VARCHAR2(30) PRIMARY KEY , -- 회원 아이디
    userPw VARCHAR2(100) NOT NULL , -- 회원 비밀번호
    email VARCHAR2(100) NOT NULL , -- 회원 이메일
    phone VARCHAR2(20) NOT NULL , -- 대표 전화번호
    rolename VARCHAR2(20) DEFAULT 'ROLE_USER' CHECK ( rolename IN ('ROLE_USER', 'ROLE_ADMIN') ) , -- 회원 권한
    enabled NUMBER(1) DEFAULT 1 CHECK ( enabled IN (0, 1) ) , -- 차단여부
    createdAt DATE DEFAULT SYSDATE -- 가입 날짜
);
-- 매장정보
CREATE TABLE BACS_STORE (
    storeId VARCHAR2(30) PRIMARY KEY , -- 매장 아이디(url에 사용할 이름)
    storeName VARCHAR2(100) NOT NULL , -- 매장 이름
    storeAddress VARCHAR2(300) DEFAULT '' , -- 매장 주소
    crNum VARCHAR2(20) NOT NULL , -- 사업자등록번호
    storePhone VARCHAR2(20) DEFAULT '' , -- 매장 번호
    createdAt DATE DEFAULT SYSDATE , -- 매장 가입날짜
    userId VARCHAR2(30) NOT NULL , -- 회원 아이디 외래키
    CONSTRAINT USER_ID_STORE_FK FOREIGN KEY (userId) REFERENCES BACS_USER(userId) -- 회원 아이디 외래키
);
-- 매장 홈페이지
CREATE TABLE BACS_HOMEPAGE (
    homepageNum NUMBER PRIMARY KEY , -- 홈페이지 번호
    templateNum NUMBER NOT NULL , -- 홈페이지 템플릿 번호
    bannerImg VARCHAR2(1000) DEFAULT '' , -- 배경 사진(추후 컬럼 추가 가능)
    storeIntro1 VARCHAR2(1000) DEFAULT '' , -- 가게 설명문1
    storeIntro2 VARCHAR2(1000) DEFAULT '' , -- 가게 설명문2
    storeIntro3 VARCHAR2(1000) DEFAULT '' , -- 가게 설명문3(추후 컬럼 추가/통폐합 가능)
    operatingHours VARCHAR2(200) DEFAULT '' , -- 매장 운영시간(ex.월-금 10:00 ~ 22:00)
    storeId VARCHAR2(30) NOT NULL , -- 매장 아이디 외래키
    CONSTRAINT STORE_ID_HOMEPAGE_FK FOREIGN KEY (storeId) REFERENCES BACS_STORE(storeId) -- 매장 아이디 외래키
);

-- 키오스크 페이지
CREATE TABLE BACS_KIOSK (
    kioskNum NUMBER PRIMARY KEY , -- 키오스크 페이지 번호
    storeCode NUMBER NOT NULL , -- 업종 번호
    easyMode NUMBER(1) DEFAULT 0 CHECK ( easyMode IN (0, 1) ) , -- 어르신모드 on/off
    voiceMode NUMBER(1) DEFAULT 0 CHECK ( voiceMode IN (0, 1) ) , -- 음성인식모드 on/off
    storeId VARCHAR2(30) NOT NULL , -- 매장 아이디 외래키
    CONSTRAINT STORE_ID_KIOSK_FK FOREIGN KEY (storeId) REFERENCES BACS_STORE(storeId) -- 매장 아이디 외래키
);

-- 메뉴 카테고리
CREATE TABLE BACS_CATEGORY (
    categoryNum NUMBER PRIMARY KEY ,
    categoryName VARCHAR2(30) NOT NULL ,
    storeId VARCHAR2(30) NOT NULL ,
    CONSTRAINT STORE_ID_CATEGORY_FK FOREIGN KEY (storeId) REFERENCES BACS_STORE(storeId)
);

-- 메뉴
CREATE TABLE BACS_MENU (
    menuNum NUMBER PRIMARY KEY , -- 메뉴번호
    menuName VARCHAR2(100) NOT NULL , -- 메뉴 이름
    menuPrice NUMBER NOT NULL , -- 메뉴 가격
    menuImg VARCHAR2(1000) DEFAULT '' , -- 메뉴 이미지
    menuDesc VARCHAR2(100) DEFAULT '' , -- 메뉴 설명
    storeId VARCHAR2(30) NOT NULL , -- 매장 아이디 외래키
    categoryNum NUMBER DEFAULT 0 , -- 메뉴 카테고리 번호 외래키
    CONSTRAINT STORE_ID_MENU_FK FOREIGN KEY (storeId) REFERENCES BACS_STORE(storeId), -- 매장 아이디 외래키
    CONSTRAINT CATEGORY_NUM_MENU_FK FOREIGN KEY (categoryNum) REFERENCES BACS_CATEGORY(categoryNum) -- 카테고리 번호
);

-- 메뉴옵션
CREATE TABLE BACS_MENU_OPTION (
    optionNum NUMBER PRIMARY KEY , -- 메뉴 옵션 번호
    optionName VARCHAR2(30) NOT NULL , -- 옵션 카테고리 이름 (ex.온도)
    optionValue VARCHAR2(100) NOT NULL , -- 옵션 값 (ex.핫, 아이스, 샷 추가 ...)
    optionPrice NUMBER NOT NULL , -- 옵션 가격(추가금)
    menuNum NUMBER NOT NULL , -- 메뉴 번호 외래키
    CONSTRAINT MENU_NUM_OPTION_FK FOREIGN KEY (menuNum) REFERENCES BACS_MENU(menuNum) -- 메뉴 번호 외래키
);

-- 주문
CREATE TABLE BACS_ORDER (
    orderNum NUMBER PRIMARY KEY , -- 주문번호
    orderDate DATE DEFAULT SYSDATE , -- 주문 날짜 TIMESTAMP로 변경고려
    totalPrice NUMBER DEFAULT 0, -- 주문 총 금액
    toGo NUMBER(1) DEFAULT 0 CHECK(toGo IN (0, 1) ), -- 포장 여부
    storeId VARCHAR2(30) NOT NULL , -- 매장 아이디 외래키
    CONSTRAINT STORE_ID_ORDER_FK FOREIGN KEY (storeId) REFERENCES BACS_STORE(storeId) -- 매장 아이디 외래키
);

-- 주문상품
CREATE TABLE BACS_ORDER_RECIPE (
    recipeNum NUMBER PRIMARY KEY , -- 주문 내역 번호
    menuAmount NUMBER DEFAULT 1 , -- 메뉴 수량
    recipePrice NUMBER DEFAULT 0 , -- 옵션 포함 메뉴 총 금액
    menuNum NUMBER NOT NULL , -- 메뉴 번호 외래키
    orderNum NUMBER NOT NULL , -- 주문번호 외래키
    CONSTRAINT MENU_NUM_RECIPE_FK FOREIGN KEY (menuNum) REFERENCES BACS_MENU(menuNum) , -- 메뉴 번호 외래키
    CONSTRAINT ORDER_NUM_RECIPE_FK FOREIGN KEY (orderNum) REFERENCES BACS_ORDER(orderNum) -- 주문 번호 외래키
);

-- 옵션정보
CREATE TABLE BACS_RECIPE_OPTION (
    roNum NUMBER PRIMARY KEY , -- 주문한 메뉴 옵션정보 번호
    roAmount NUMBER DEFAULT 1 , -- 옵션 수량
    recipeNum NUMBER NOT NULL , -- 주문 상품 번호 외래키
    optionNum NUMBER NOT NULL , -- 메뉴 옵션 번호 외래키
    CONSTRAINT RECIPE_NUM_OPTION_FK FOREIGN KEY (recipeNum) REFERENCES BACS_ORDER_RECIPE(recipeNum) , -- 주문 내역 외래키
    CONSTRAINT OPTION_NUM_OPTION_FK FOREIGN KEY (optionNum) REFERENCES BACS_MENU_OPTION(optionNum) -- 메뉴 옵션 외래키
);

-- BACS 공지사항
CREATE TABLE BACS_NOTICE (
    noticeNum NUMBER PRIMARY KEY , -- 공지사항 번호
    noticeTitle VARCHAR2(100) NOT NULL , -- 공지사항 제목
    noticeContents VARCHAR2(2000) NOT NULL , -- 공지사항 내용
    noticeViews NUMBER DEFAULT 0 , -- 조회수
    createdAt DATE DEFAULT SYSDATE , -- 게시 날짜
    userId VARCHAR2(30) NOT NULL , -- 회원 외래키
    CONSTRAINT USER_ID_NOTICE_FK FOREIGN KEY (userId) REFERENCES BACS_USER(userId) -- 회원 외래키
);

-- 매장 공지사항
CREATE TABLE STORE_NOTICE (
    noticeNum NUMBER PRIMARY KEY , -- 매장 공지사항 번호
    noticeTitle VARCHAR2(100) NOT NULL , -- 매장 공지사항 제목
    noticeContents VARCHAR2(2000) NOT NULL , -- 매장 공지사항 내용
    noticeViews NUMBER DEFAULT 0 , -- 조회수
    createdAt DATE DEFAULT SYSDATE , -- 게시날짜
    storeId VARCHAR2(30) NOT NULL , -- 매장 아이디 외래키
    CONSTRAINT STORE_ID_NOTICE_FK FOREIGN KEY (storeId) REFERENCES BACS_STORE(storeId) -- 매장 아이디 외래키
);



-- 시퀀스
-- 홈페이지 시퀀스
CREATE SEQUENCE BACS_HOMEPAGE_SEQ;
-- 키오스크 시퀀스
CREATE SEQUENCE BACS_KIOSK_SEQ;
-- 카테고리 시퀀스
CREATE SEQUENCE BACS_CATEGORY_SEQ;
-- 메뉴 시퀀스
CREATE SEQUENCE BACS_MENU_SEQ;
-- 메뉴옵션 시퀀스
CREATE SEQUENCE BACS_MENU_OPTION_SEQ;
-- 주문 시퀀스
CREATE SEQUENCE BACS_ORDER_SEQ;
-- 주문상품 시퀀스
CREATE SEQUENCE BACS_ORDER_RECIPE_SEQ;
-- 옵션정보 시퀀스
CREATE SEQUENCE BACS_RECIPE_OPTION_SEQ;
-- 공지사항 시퀀스
CREATE SEQUENCE BACS_NOTICE_SEQ;
-- 매장공지 시퀀스
CREATE SEQUENCE STORE_NOTICE_SEQ;